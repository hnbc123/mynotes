# 1 基础linux命令
## 1.1 man命令中常用按键以及用途
| 按键 | 用途 |
| :--: | :--: |
| 空格键 | 向下翻一页 |
| Page Down | 向下翻一页 |
| Page up | 向上翻一页 |
| home | 直接前往首页 |
| end | 直接前往尾页 |
| / | 从上至下搜索关键词 |
| ？ | 从下至上搜索关键词 |
| n | 定位到下一个搜索到的关键词 |
| N | 定位到上一个搜索到的关键词 |
| q | 退出帮助文档 |

## 1.2 常用系统工作命令
### 1.2.1 echo命令
> 用于在终端输出字符串或变量提取后的值，格式为“echo [字符串|$变量]”。

### 1.2.2 date命令
> 显示及设置系统的时间或日期，格式为“date [选项] [+指定的格式]”。

| 参数 | 作用 |
| :--: | :--: |
| %t | 跳格[Tab 建] |
| %H | 小时（00~23）|
| %I | 小时（00~12）|
| %M | 分钟（00~59）|
| %S | 秒（00~59）|
| %j | 今年中的第几天 |

* date  (默认格式查看当前系统时间)
* date "+%Y-%m-%d %H:%M:%S"
* date -s "20170901 8:30:00" 设置系统当前时间
* date "+%j"

### 1.2.3 reboot命令
> 用于重启系统，格式为reboot

### 1.2.4 poweroff命令
> 用于关闭系统，格式为poweroff

### 1.2.5 wget命令
> 用于在终端中下载网络文件，格式为“wget [参数] 下载地址”

| 参数 | 作用 |
| :--: | :--: |
| -b | 后台下载模式 |
| -P | 下载到指定目录 |
| -t | 最大尝试次数 |
| -c | 断电续传 |
| -p | 下载页面内所有资源，包括图片、视频等 |
| -r | 递归下载 |

### 1.2.6 ps命令
> 用于查看系统中的进程状态，格式为“ps [参数]”。

| 参数 | 作用 |
| :--: | :--:|
| -a | 显示所有进程 |
| -u | 用户以及其他详细信息 |
| -x | 显示没有控制终端的进程 |

Linux常见进程状态：  

* R（运行）：进程正在运行或在运行队列中等待。
* S（中断）：进程处于休眠中，当某个条件形成后或者接收到信号时，则脱离该状态。
* D（不可中断）：进程不响应系统异步信号，即便用kill命令也不能将其中断。
* Z（僵死）：进程已经终止，但进程描述符依然存在，直到父进程调用wait4()系统函数后将进程释放。
* T（停止）：受到停止信号后停止运行。

### 1.2.7 top命令
> 用于动态地监视进程活动与系统负载等信息，其格式为top。

### 1.2.8 pidof命令
> pidof命令用于查询某个指定服务进程的PID值，格式为“pidof [参数] [服务名称]”

### 1.2.9 kill命令
> 用于终止某个指定PID的服务进程，格式为“kill [参数] [进程PID]”。

### 1.2.10 killall命令
> 用于终止某个指定名称的服务所对应的全部进程，格式为“killall [参数] [进程名称]”。

## 1.3 系统状态检测命令
### 1.3.1 ifconfig命令
> 用于获取网卡配置与网络状态等信息，格式为“ifconfig [网络设备] [参数]”。

### 1.3.2 uname命令
> 用于查看系统内核与系统版本等信息，格式为“uname [-a]”。

### 1.3.3 uptime命令
> 用于查看系统的负载信息，格式为uptime。

### 1.3.4 free命令
> 用于显示当前系统中内存的使用量信息，格式为“free [-h]”。

### 1.3.5 who命令
> 用于查看当前登入主机的用户终端信息，格式为“who [参数]”。

### 1.3.6 last命令
> 用于查看所有系统的登录记录，格式为“last [参数]”。

### 1.3.7 history命令
> 用于显示历史执行过的命令，格式为“history [-c]”。  
> 历史命令会被保存到.bash_history文件中。Linux系统中以点(.)开头的文件均代表隐藏文件。  
> 要清空历史记录可执行“history -c”

### 1.3.8 sosreport命令
> 用于收集系统配置及架构信息并输出诊断文件，格式为sosreport。

## 1.4 工作目录切换命令
### 1.4.1 pwd命令
> 用于显示用户当前所处的工作目录，格式为“pwd [选项]”。

### 1.4.2 cd命令
> 用于切换工作路径，格式为“cd [目录名称]”。


* cd -  （返回上一次的目录）
* cd ~  （切换到用户的家目录）

### 1.4.3 ls命令
> 用于显示目录中的文件信息，格式为“ls [选项] [文件]”。

* “-a”：看到全部文件（包括隐藏文件）
* “-l”：查看文件属性、大小等详细信息。
* “-d”：目录属性信息

## 1.5 文本文件编辑命令
### 1.5.1 cat命令
> 用于查看纯文本文件，格式为“cat [选项] [文件]”。

### 1.5.2 more命令
> 用于查看纯文本文件（内容较多的）。

### 1.5.3 head命令
> 用于查看纯文本文档的前N行，格式为“head [选项] [文件]”。

### 1.5.4 tail命令
> 用于查看纯文本文档的后N行或持续刷新内容，格式为“tail [选项] [文件]”。
> 想要实时查看最新文件时，格式为“tail -f 文件名”。

### 1.5.5 tr命令
> 用于替换文本文件中的字符，格式为“tr [原始字符] [目标字符]”。

### 1.5.6 wc 命令
> 用于统计指定文本的行数、字数、字节数，格式为“wc [参数] 文本”。

| 参数 | 作用 |
| :--: | :--: |
| -l | 只显示行数 |
| -w | 只显示单词数 |
| -c | 只显示字节数 |

### 1.5.7 stat命令
> 用于查看文件的具体存储信息，格式为“stat 文件名称”。

### 1.5.8 cut命令
> cut命令用于按列提取文本字符，格式为“cut [参数] 文本”。
> -f：需要看的列数；-d：间隔符号。  
> 例： cut -d: -f1 /etc/passwd

### 1.5.9 diff命令
> 用于比较对个文本文件的差异，格式为“diff [参数] 文件”。  
> 可以使用--brief参数来确认两个文件是否不同，例如：diff --brief diff_A.txt diff_B.txt。  
> 可以使用-c参数比较多个文件的差异之处，例如：diff -c diff_A.txt diff_B.txt。

## 1.6 文件目录管理命令
### 1.6.1 touch命令
> 用于创建空白文件或设置文件的时间，格式为“touch [选项] [文件]”。

| 参数 | 作用 |
| :--: | :--: |
| -a | 仅修改“读取时间”(atime) |
| -m | 仅修改“修改时间”(mtime) |
| -d | 同时修改atime与mtime |

### 1.6.2 mkdir命令
> 用于创建空白的目录，格式为“mkdir [选项] 目录”。  
> 可以结合-p参数来递归创建出具有层叠关系的文件目录。

### 1.6.3 cp命令
> 用于复制文件或目录，格式为“cp [选项] 源文件 目标文件”。

复制分三种情况：
* 如果目标文件是目录，则会把源文件复制到该目录中。
* 如果目标文件也是普通文件，则会询问是否要覆盖它。
* 如果目标文件不存在，则执行正常的复制操作。

| 参数 | 作用 |
| :--: | :--: |
| -p | 保留原始文件的属性 |
| -d | 若对象为“链接文件”，则保留该“链接文件”的属性 |
| -r | 递归持续复制（用于目录）|
| -i | 若目标文件存在则询问是否覆盖 |
| -a | 相当于 -pdr |

### 1.6.4 mv命令
> 用于剪切文件或将文件重命名，格式为“mv [选项] 源文件 [目标路径|目标文件名]”。

### 1.6.5 rm命令
> 用于删除文件或目录，格式为“rm [选项] 文件”。  
> 删除目录时需要在rm命令后加-r参数，强制删除加-f参数

### 1.6.6 dd命令
> 用于按照指定大小和个数的数据块来复制文件或转换文件，格式为“dd   [参数]”

| 参数 | 作用 |
| :--: | :--: |
| if | 输入的文件名称 |
| of | 输出的文件名称 |
| bs | 设置每个“块”的大小 |
| count | 设置要复制“块”的个数 |

### 1.6.6 file命令
> 用于查看文件的类型，格式为“file 文件名”。

## 1.7 打包压缩与搜索命令
### 1.7.1 tar命令
> 用于对文件进行打包压缩或解压，格式为“tar [选项] [文件]”。

| 参数 | 作用 |
| :--: | :--: |
| -c | 创建压缩文件 |
| -x | 解开压缩文件 |
| -t | 查看压缩包内有哪些文件 |
| -z | 用Gzip压缩或解压 |
| -j | 用bzip2压缩或解压 |
| -v | 显示压缩或解压的过程 |
| -f | 目标文件名 |
| -P | 保留原始的权限与属性 |
| -p | 使用绝对路径压缩 |
| -C | 指定解压到的目录 |

### 1.7.2 grep命令
> 用于在文本中执行关键词搜索，并显示匹配的结果，格式为“grep [选项] [文件]”。

| 参数 | 作用 |
| :--: | :--: |
| -b | 将可执行文件（binary）当作文本文件来搜索 |
| -c | 仅显示找到的行数 |
| -i | 忽略大小写 |
| -n | 显示行号 |
| -v | 反向选择——仅列出没有关键词的行 |

### 1.7.3 find命令
> 用于按照指定条件来查找文件，格式为“find [查找路径] 寻找条件 操作”。

| 参数 | 作用 |
| :--: | :--: |
| -name | 匹配名称 |
| -perm | 匹配权限（mode为完全匹配，mode为包含即可）|
| -user | 匹配所有者 |
| -group | 匹配所有组 |
| -mtime -n +n |匹配修改内容的时间（-n指n天以内，+n指n天以前）|
| -atime -n +n | 匹配访问文件的时间 |
| -ctime -n +n | 匹配修改文件权限的时间 |
| -nouser | 匹配无所有者的文件 |
| -nogroup | 匹配无所有组的文件 |
| -newer f1 !f2 | 匹配比文件f1新但比f2旧的文件 |
| --type b/d/c/p/l/f | 匹配文件类型（块设备/目录/字符设备/管道/链接文件/文本文件）|
| -size | 匹配文件的大小 |
| -prune | 忽略某个目录 |
| -exec ...... {} \; | 后面可跟用于进一步处理搜索结果的命令 |

> 例：在整个文件系统中找出所有归属于linuxprobe用户的文件并复制到/root/findresults目录。  
> find / -user linuxprobe -exec cp -a {} /root/findresults/ \;

# 2 管道符、重定向与环境变量
## 2.1 输入输出重定向
* 标准输入重定向（STDIN，文件描述符为0）：默认从键盘输入，也可从其他文件或命令中输入。
* 标准输出重定向（STDOUT，文件描述符为1）：默认输出到屏幕。
* 错误输出重定向（STDERR，文件描述符为2）：默认输出到屏幕。

**输入重定向中用到的符号及作用**

| 符号 | 作用 |
| :--: | :--: |
| 命令 < 文件 | 将文件作为命令的标准输出 |
| 命令 << 分界符 | 从标准输入中读入，直到遇见分界符才停止 |
| 命令 < 文件1 > 文件2 | 将文件1作为命令的标准输入并将标准输出到文件2 |

**输出重定向中用到的符号及作用**

| 符号 | 作用 |
| :--: | :--: |
| 命令 > 文件 | 将标准输出重定向到一个文件中（清空原有文件的数据）|
| 命令 2> 文件 | 将错误输出重定向到一个文件中（清空原有文件的数据）|
| 命令 >> 文件 | 将标准输出重定向到一个文件中（追加到原有内容的后面）|
| 命令 2>> 文件 | 将错误输出重定向到一个文件中（追加到原有内容的后面）|
| 命令 >> 文件 2> &1 或 命令 &>> 文件 | 将标准输出与错误输出共同写入到文件中（追加到原有内容的后面）|

## 2.2 管道命令符
> 用于把前一个命令原本要输出到屏幕的数据当作是后一个命令的标准输入，格式为“命令A | 命令B”。

## 2.3 命令行的通配符
* 星号（*）代表零个或多个字符
* 问号（?）代表匹配单个字符
* [0-9] 表示匹配0~9之间的单个数字的字符
* [abc] 表示匹配a、b、c三个字符中的任意一个字符

## 2.4 常用的转义字符
* 反斜杠（\）：使反斜杠后面的一个变量变为单纯的字符串。
* 单引号（''）：转移其中所有的变量为单纯的字符串。
* 双引号（""）：保留其中的变量属性，不进行转义处理。
* 反引号（``）：把其中的命令执行后返回结果。

## 2.5 重要的环境变量
| 变量名称 | 作用 |
| :--: | :--: |
| HOME | 用户的主目录（即家目录）|
| SHELL | 用户在使用的Shell解释器名称 |
| HISTSIZE | 输出的历史命令记录条数 |
| HISTFILESIZE | 保存的历史命令记录条数 |
| MAIL | 邮件保存路径 |
| LANG | 系统语言、语系名称 |
| RANDOM | 生成一个随机数字 |
| PS1 | Bash解释器的提示符 |
| PATH | 定义解释器搜索用户执行命令的路径 |
| EDITOR | 用户默认的文本编辑器 |

# 3 Vim编辑器与Shell命令脚本
## 3.1 Vim文本编辑器
Vim编辑器的三种模式：  

* 命令模式：控制光标移动，可对文本进行复制、粘贴、删除和查找等工作。
* 输入模式：正常的文本录入。
* 末行模式：保存或退出文档，以及设置编辑环境。  

**命令模式中常用的命令** 
 
| 命令 | 作用 |
| :--: | :--: |
| dd | 删除（剪切）光标所在整行 |
| 5dd | 删除（剪切）从光标处开始的5行 |
| yy | 复制光标所在整行 |
| 5yy | 复制从光标处开始的5行 |
| n | 显示搜索命令定位到的下一个字符串 |
| N | 显示搜索命令定位到的上一个字符串 |
| u | 撤销上一步的操作 |
| p | 将之前删除或复制过的数据粘贴到光标后面 |


**末行模式中可用的命令**

| 命令 | 作用 |
| :--: | :--: |
| :w | 保存 |
| :q | 退出 |
| :q! | 强制退出（放弃对文档的修改内容）|
| :wq! | 强制保存退出 |
| :set nu | 显示行号 |
| :set nonu | 不显示行号 |
| :命令 | 执行该命令 |
| :整数 | 跳转到该行 |
| :s/one/two | 将当前光标所在行的第一个one替换成two |
| :s/one/two/g | 将当前光标所在行的所有one替换成two |
| :%s/one/two/g | 将全文中的所有one替换成two |
| ?字符串 | 在文本中从下至上搜索该字符串 |
| /字符串 | 在文本中从上至下搜索该字符串 |

## 3.2 编写Shell脚本
Shell脚本命令的工作方式：  

* 交互式(Interactive)：用户每输入一条命令就立即执行。
* 批处理(Batch)：由用户事先编写好一个完整的Shell脚本，Shell会一次性执行脚本中诸多的命令。

**接受用户参数**

* $#：对应总共几个参数
* $*：对应所有位置的参数值
* $?：对应显示上一次命令的执行返回值
* $1、$2、$3...... 分别对应第N个位置的参数值

**文件测试所用的参数**  

| 运算符 | 作用 |
| :--: | :--: |
| -d | 测试文件是否为目录类型 |
| -e | 测试文件是否存在 |
| -f | 判断是否为一般文件 |
| -r | 测试当前用户是否有权限读取 |
| -w | 测试当前用户是否有权限写入 |
| -x | 测试当前用户是否有权限执行 |

例：[ ! $USER = root ] && echo "user" || "root"

**可用的整数比较运算符**

| 运算符 | 作用 |
| :--: | :--: |
| -eq | 是否等于 |
| -ne | 是否不等于 |
| -gt | 是否大于 |
| -lt | 是否小于 |
| -le | 是否等于或小于 |
| -ge | 是否大于或等于 |

**常见的字符串比较运算符**

| 运算符 | 作用 |
| :--: | :--: |
| = | 比较字符串内容是否相同 |
| != | 比较字符串内容是否不同 |
| -z | 判断字符串内容是否为空 |

## 3.3 流程控制语句
### 3.3.1 if条件测试语句

	if 条件测试操作1   
	    then 命令序列1
	elif 条件测试操作2
		then 命令序列2
	else
		命令序列3   
	fi

### 3.3.2 for条件循环语句

	for 变量名 in 取值列表
	do
		命令序列
	done

### 3.3.3 while条件循环语句

	while 条件测试操作
	do
		命令序列
	done

### 3.3.4 case条件测试语句

	case 变量值 in
	模式1)
		命令序列1
		；；
	模式2）
		命令序列2
		；；
	*）
		默认命令序列
	esac

## 3.4 计划任务服务程序
* 一次性计划任务
> 格式为“at 时间”。“at -l”命令用于查看已设置好但还未执行的一次性计划任务；“atrm 任务序号”命令可以将其删除。

* 长期性计划任务
> 格式为“分、时、日、月、星期 命令”。创建、编辑计划任务的命令为“crontab -e”，查看当前计划任务的命令为“crontab -l”,删除某条计划任务的命令为“crontab -r”。、

| 字段 | 说明 |
| :--: | :--: |
| 分 | 取值为0~59的整数 |
| 时 | 取值为0~23的整数 |
| 日 | 取值为1~31的整数 |
| 月 | 取值为1~12的整数 |
| 星期 | 取值为0~7的任意整数，其中0与7均为星期日 |

例： 25 3 * * 1,3,5 /user/bin/tar -czvf backup.tar.gz /home/wwwroot   
逗号表示多个时间段，例如“8,9,12”；减号表示一段连续的时间周期，例如“12-15”；用除号表示执行任务的间隔时间，例如“/2”表示每隔2分钟执行一次任务。

# 4 用户身份与文件权限
## 4.1 用户身份与能力
### 4.1.1 useradd命令
> 用于创建新的用户，格式为“useradd [选项] 用户名”。

| 参数 | 作用 |
| :--: | :--: |
| -d | 指定用户的家目录(默认为/home/username) |
| -e | 账户的到期时间，格式为YYYY-MM-DD |
| -u | 指定该用户的默认UID |
| -g | 指定一个初始的用户基本组(必须已存在) |
| -G | 指定一个或多个扩展用户组 |
| -N | 不创建与用户同名的基本用户组 |
| -s | 指定该用户的默认Shell解释器 |

### 4.1.2 groupadd命令
> 用于创建用户组，格式为“groupadd [选项] 群组名”。

### 4.1.3 usermod命令
> 用户修改用户的属性，格式为“usermod [选项] 用户名”

| 参数 | 作用 |
| :--: | :--： |
| -c | 填写用户账户的备注信息 |
| -d -m | 重新指定用户的家目录并自动把旧的数据转移过去 |
| -e | 账户的到期时间，格式为YYYY-MM-DD |
| -g | 变更所属用户组 |
| -G | 变更扩展用户组 |
| -L | 锁定用户禁止其登录系统 |
| -U | 解锁用户，允许其登录系统 |
| -s | 变更默认终端 |
| -u | 修改用户的UID |

### 4.1.4 passwd命令
> 用于修改用户密码、过期时间、认证信息等，格式为“passwd [选项] [用户名]”。

| 参数 | 作用 |
| :--: | :--: |
| -l | 锁定用户，禁止其登录 |
| -u | 解除锁定，允许用户登录 |
| --stdin | 允许通过标准输入修改用户密码 |
| -d | 使该用户可用空密码登录系统 |
| -e | 强制用户在下次登录时修改密码 |
| -S | 显示用户的密码是否被锁定，以及密码所采用的加密算法名称 |

### 4.1.5 userdel命令
> 用于删除用户，格式为“userdel [选项] 用户名”。

| 参数 | 作用 |
| :--: | :--: |
| -f | 强制删除用户 |
| -r | 同时删除用户及用户家目录 |

## 4.2 文件权限与归属
常见的文件类型：
* -：普通文件
* d：目录文件
* l：链接文件
* b：块设备文件
* c：字符设备文件
* p：管道文件

**文件权限的字符与数字表示**

| 权限项 | 读 | 写 | 执行 |
| :--: | :--: | :--: |
| 字符表示 | r | w | x |
| 数字表示 | 4 | 2 | 1 |

## 4.3 文件的特殊权限
### 4.3.1 SUID
> SUID是一种对二进制程序进行设置的特殊权限，可以让二进制程序的执行者临时拥有属主的权限（仅对拥有执行权限的二进制程序有效）。

### 4.3.2 SGID
> SGID主要实现如下两种功能：  
> 
* 让执行者临时拥有属组的权限（对拥有权限的二进制程序进行设置）
* 在某个目录中创建的文件自动继承该目录的用户组（只可以对目录进行设置）

chmod命令用来设置文件或目录的权限，格式为“chmod [参数] 权限 文件或目录名称”。例： chmod 760 test  

chown命令用于设置文件或目录的所有者和所属组，格式为“chown [参数] 所有者:所属组 文件或目录名称”。

chmod和chown命令针对目录进行操作时需要加-R表示递归操作。

### 4.3.3 SBIT
> 确保用户只能删除自己的文件，而不能删除其他用户的文件。
> 参数 o+t 代表设置SBIT粘滞位权限。
> 例：chmod -R o+t linux/

## 4.4 文件的隐藏属性
### 4.4.1 chattr命令
> 用于设置文件的隐藏权限，格式为“chattr [参数] 文件”。如果想把某个隐藏功能添加到文件上，则需要在命令后面追加“+参数”；如果想把某个隐藏功能移出文件，则需要追加“-参数”。

| 参数 | 作用 |
| :--: | :--: |
| i | 无法对文件进行修改；若对目录设置了改参数，则仅能修改其中的子文件内容而不能新建或删除文件 |
| a | 仅允许补充（追加）内容，无法覆盖/删除内容（Append Only）|
| S | 文件内容在变更后立即同步到硬盘（sync）|
| s | 彻底从硬盘中删除，不可恢复（用0填充源文件所在硬盘区域）|
| A | 不再修改这个文件或目录的最后访问时间（atime）|
| b | 不再修改文件或目录的存取时间 |
| D | 检查压缩文件中的错误 |
| d | 使用dump命令备份时忽略本文件/目录 |
| c | 默认将文件或目录进行压缩 |
| u | 当删除该文件后依然保留其在硬盘中的数据，方便日后恢复 |
| t | 让文件系统支持尾部合并（tail-merging）|
| X | 可以直接访问压缩文件中的内容 |

### 4.4.2 lsattr命令
> 用于显示文件的隐藏权限，格式为“lsattr [参数] 文件”。 

## 4.5 文件访问控制列表
### 4.5.1 setfacl命令
> 用于管理文件的ACL规则，格式为“setfacl [参数] 文件名称”。其中，针对目录文件需要使用-R递归参数；针对普通文件则使用-m参数；如果想删除某个文件的ACL可以使用-b参数。

### 4.5.2 getfacl命令
> 用于显示文件上设置的ACL信息，格式为“getfacl 文件名称”。

## 4.6 su命令与sudo服务
> su命令可以在当前用户不退出登录的情况下切换到其他用户,
> 例：su - linuxprobe。 其中减号意味着完全切换到新的用户，而不保存原始的信息。


> sudo命令用于给普通用户提供额外的权限来完成原本root管理员才能完成的任务，格式为“sudo [参数] 命令名称”。

sudo服务中的可用参数及作用

| 参数 | 作用 |
| :--: | :--: |
| -h | 列出帮助信息 |
| -l | 列出当前用户可执行的命令 | 
| -u 用户名或UID值 | 以指定的用户身份执行命令 |
| -k | 清空密码的有效时间 |
| -b | 在后台执行指定的命令 |
| -p | 更改询问密码的提示语 |

# 5 存储结构与磁盘划分
## 5.1 常见的目录名称以及相应内容
| 目录名称 | 应放置文件的内容 |
| :--: | :--: |
| /boot | 开机所需文件 |
| /dev | 以文件形式存放任何设备与接口 |
| /etc | 配置文件 |
| /home | 用户家目录 |
| /bin | 存放单用户模式下还可以操作的命令 |
| /lib | 开机时用到的函数库，以及/bin与/sbin下面的命令要调用的函数 |
| /sbin | 开机过程中需要的命令 |
| /media | 用于挂载设备文件的目录 |
| /opt | 放置第三方的软件 |
| /root | 系统管理员的家目录 |
| /srv | 一些网络服务的数据文件目录 |
| /tmp | 任何人均可使用的“共享”临时目录 |
| /proc | 虚拟文件系统，例如系统内核、进程、外部设备及网络状态等|
| /usr/local | 用户自行安装的软件 |
| /usr/sbin | Linux系统开机时不会使用到的软件/命令/脚本 |
| /usr/share | 帮助与说明文件，也可放置共享文件 |
| /var | 主要存放经常变化的文件，如日志 |
| /lost+found | 当文件系统发生错误时，将一些丢失的文件片段存放在这里 |

## 5.2 物理设备的命名规则
| 硬件设备 | 文件名称 |
| :--: | :--: |
| IDE设备 | /dev/hd[a-d] |
| SCSI/SATA/U盘 | /dev/sd[a-p] |
| 软驱 | /dev/fd[0-1] |
| 打印机 | /dev/lp[0-15] |
| 光驱 | /dev/cdrom |
| 鼠标 | /dev/mouse |
| 磁带机 | /dev/st0 或 /dev/ht0 |

## 5.3 挂载硬件设备
### 5.3.1 mount命令
> 用于挂载文件系统，格式为“mount 文件系统 挂载目录”。

**mount命令中的参数及作用**

| 参数 | 作用 |
| :--: | :--: |
| -a | 挂载所有在/etc/fstab中定义的文件系统 |
| -t | 指定文件系统的类型 |

例：把设备/dev/sdb2挂载到/backup目录

	mount /dev/sdb2 /backup

**用于挂载信息的指定填写格式中，各字段所表示的意义**

| 字段 | 意义 |
| :--: | :--: |
| 设备文件 | 一般为设备的路径+设备名称 |
| 挂载目录 | 指定要挂载到的目录，需在挂载前创建好 |
| 格式类型 | 指定文件系统的格式 |
| 权限选项 | 若设置为defaults，则默认权限为：rw,suid,dev,exec,auto,nouser,async |
| 自检 | 若为1则开机后进行磁盘自检，为0则不自检 |
| 优先级 | 若“自检”字段为1，则可对多块硬盘进行自检优先级设置 |

若想将系统文件为ext4的硬件设备/dev/sdb2在开机后自动挂载到/backup目录上，并保持默认权限且无需开机自检，就需要在/etc/fstab文件中写入相应信息。

### 5.3.2 umount命令
> 用于撤销已经挂载的设备文件，格式为“umount[挂载点/设备文件]”。

## 5.4 添加硬件设备
### 5.4.1 fdisk命令
**fdisk命令中的参数以及作用**

| 参数 | 作用 |
| :--: | :--: |
| m | 查看全部可用的参数 |
| n | 添加新的分区 |
| d | 删除某个分区信息 |
| l | 列出所有可用的分区类型 |
| t | 改变某个分区的类型 |
| p | 查看分区信息 |
| w | 保存并退出 |
| q | 不保存直接退出 |

### 5.4.2 du命令
> 用于查看文件数据占用量，格式为“du [选项] [文件]”

## 5.5 添加交换分区
> SWAP(交换)分区是一种通过在硬盘中预先划分一定的空间，然后将把内存中暂时不常用的数据临时存放到硬盘中，以便腾出物理内从空间让更活跃的程序服务来使用的技术，其设计目的是解决真实物理内存不足的问题。

## 5.6 磁盘容量配额
> 限制某位用户或某个用户组针对特定文件夹可以使用的最大硬盘空间或最大文件个数，一旦达到最大值就不再允许继续使用。
> 
* 软限制：当达到软限制时会提示用户，但仍允许用户在限定的额度内继续使用。
* 硬限制：当达到硬限制时会提示用户，且强制终止用户的操作。

### 5.6.1 xfs_quota命令
> 格式为"quota [参数] 配额 文件系统"   
>  -c参数用于以参数的形式设置要执行的命令   
>  -x参数是专家模式，可以进行更多复杂的配置

### 5.6.2 edquota命令
> 用于编辑用户的quota配额限制，格式为“edquota [参数] [用户]”

## 5.7 软硬方式链接
* 硬链接：可以理解为“指向原始文件inode的指针”，系统不为它分配独立的inode和文件，所以硬链接文件和原始文件其实是同一个文件。每添加一个硬链接，给文件的inode连接时就会增加1。
* 软链接(也称为符号链接)：仅包含所链接文件的路径名，因此能链接目录文件，也可以跨越文件系统进行链接。

In命令用于创建链接文件，格式为“In [选项] 目标”。

| 参数 | 作用 |
| :--: | :--: |
| -s | 创建“符号链接”，默认创建硬链接 |
| -f | 强制创建文件或目录的链接 |
| -i | 覆盖前先询问 |
| -v | 显示创建链接的过程 |


# 6 使用RAID与LVM磁盘阵列技术
## 6.1 RAID（独立冗余磁盘阵列）
### 6.1.1 RAID 0
> RAID 0技术把多块物理硬盘设备（至少两块）通过硬件或软件的方式串联在一起，组成一个大的卷组，并将数据一次写入到各个物理硬盘中。  
> RAID 0技术能有效地提升硬盘数据的吞吐速度，但是不具备数据备份和错误修复能力。

### 6.1.2 RAID 1
> RAID 1技术把两块以上的硬盘设备进行绑定，在写入数据时，同时将数据写入到多块硬盘设备上（可以将其视为数据的镜像或备份）。当其中某一块硬盘发生故障后，一般会立即自动以热交换的方式来恢复数据的正常使用。

### 6.1.3 RAID 5
> RAID5技术把硬盘设备的数据奇偶校验信息保存到处自身以外的其他每一块硬盘设备上。  
> RADI5技术实际上没有备份硬盘中的真实数据信息，而是当硬盘设备出现问题后通过奇偶校验信息来尝试重建损坏的数据。

### 6.1.4 RAID 10
> RAID10技术需要至少4块硬盘来组建，其中先分别两两制作成RAID1磁盘阵列，以保证数据的安全性；然后再对两个RAID1磁盘阵列实施RAID0技术，进一步提高硬盘设备的读写速度。

### 6.1.5 部署磁盘阵列
mdadm命令用于管理Linux系统中的软件RAID硬盘阵列，格式为“mdadm [模式] < RAID 设备名称 > [选项] [成员设备名称]”。

| 参数 | 作用 |
| :--: | :--: |
| -a | 检测设备名称 |
| -n | 指定设备数量 |
| -l | 指定RAID级别 |
| -C | 创建 |
| -v | 显示过程 |
| -f | 模拟设备损坏 |
| -r | 移除设备 |
| -Q | 查看摘要信息 |
| -D | 查看详细信息 |
| -S | 停止RAID磁盘阵列 |

## 6.2 LVM(逻辑卷管理器)
### 6.2.1 部署逻辑卷
**常用的LVM部署命令**

| 功能/命令 | 物理卷管理 | 卷组管理 | 逻辑卷管理 |
| :--: | :--: | :--: | :--: |
| 扫描 | pvscan | vgscan | lvscan |
| 建立 | pvcreate | vgcreate | lvcreate |
| 显示 | pvdisplay | vgdisplay | lvdisplay |
| 删除 | pvremove | vgremove | lvremove |
| 扩展 | | vgextend | lvextend |
| 缩小 | | vgexduce | lvreduce |

* 第一步：让新添加的两块硬盘设备支持LVM技术。
	> pvcreate /dev/sdb /dev/sdc

* 第二步：把两块硬盘设备加入到storage卷组中，然后查看卷组的状态。
	> vgcreate storage /dev/sdb /dev/sdc
	> vgdisplay

* 第三步：切割出一个约为150MB的逻辑卷设备。
	> lvcreate -n vo -l 37 storage

* 第四步：把生成好的逻辑卷进行格式化，然后挂载使用。
	> mkfs.ext4 /dev/storage/vo
	> mkdir /linuxprobe
	> mount /dev/storage/vo /linuxprobe

* 第五步：查看挂载状态，并写入到配置文件，使其永久生效。
	> df -h
	> echo "/dev/storage/vo /linuxprobe ext4 defaults 0 0" >> /etc/fstab

### 6.2.2 扩容逻辑卷
* 第一步：把逻辑卷vo扩展至290MB。
	> lvextend -L 290M /dev/storage/vo

* 第二步：检查硬盘完整性，并重置硬盘容量。
	> e2fsck -f /dev/storage/vo

* 第三步：重新挂载硬盘设备并查看挂载状态。
	> mount -a
	> df -h

### 6.2.3 缩小逻辑卷
* 第一步：检查文件系统的完整性
	> e2fsck -f /dev/storage/vo

* 第二步：把逻辑卷vo的容量减小到120MB。
	> resize2fs /dev/storage/vo 120M

* 第三步：重新挂载文件系统并查看系统状态。
	> mount -a
	> df -h

### 6.2.4 逻辑卷快照
LVM的快照卷功能有两个特点：

* 快照卷的容量必须等同于逻辑卷的容量
* 快照卷仅一次有效，一旦执行还原操作后则会被立即自动删除

步骤：

* 第一步：使用-s参数生成一个快照卷，使用-L参数指定切割的大小，在命令后面写上是针对哪个逻辑卷执行的快照操作。

	> lvcreate -L 120M -s -n SNAP /dev/storage/vo
	> lvdisplay
	> open 0

* 第二步：在逻辑卷所挂载的目录中创建一个100MB的垃圾文件，然后再查看快照卷的状态，可以发现存储空间占的用量上升了。

	> dd if=/dev/zero of=/linuxprobe/files count=1 bs=100M
	> lvdisplay
	> open 0

* 第三步：为了校验SNAP快照卷的效果，需要对逻辑卷进行快照还原操作。在此之前需先卸载掉逻辑卷设备与目录的挂载。

	> umount /linuxprobe
	> lvconvert --merge /dev/storage/SNAP

* 第四步：快照卷会被自动删除掉，并且刚刚在逻辑卷设备被执行快照操作后再创建出来的100MB的垃圾文件也被清除了。

	> mount -a
	> ls /linuxprobe

### 6.2.5 删除逻辑卷
* 第一步：取消逻辑卷与目录的挂载关联，删除配置文件中永久生效的设备参数。

	> umount /linuxprobe
	> vim /etc/fstab

* 第二步：删除逻辑卷设备，需要输入y来确认操作。

	> lvremove /dev/storage/vo

* 第三步：删除卷组，此处只写卷组名称即可，不需要设备的绝对路径。

	> vgremove storage

* 第四步：删除物理卷设备。

	> pvremove /dev/sdb /dev/sdc

